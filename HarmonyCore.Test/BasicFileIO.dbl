import System
import Microsoft.VisualStudio.TestTools.UnitTesting
import Harmony.Core
import Harmony.Core.FileIO
import HarmonyCore.Test

namespace Harmony.Core.Test
	{TestClass}
	public class BasicFileIO
		{TestMethod}
		public method ReadInputRelative, void
		proc
			data status, i4
			setlog("DAT", EnvironmentRootBuilder.FindRelativeFolderForAssembly("Dat"), status)
			disposable data fileIO = new IsamDataObjectIO<Orders>(new FileChannelManager(), "DAT:orders.ddf", FileOpenMode.InputRelative)
			data firstOrder, @Orders
			data lastOrder, @Orders
			data nextOrder, @Orders
			data shouldBeFirstOrder, @Orders
			data shouldBeFirstOrder2, @Orders

			Assert.AreEqual(Harmony.Core.FileIO.FileAccessResults.Success, fileIO.ReadFirstRecord(firstOrder))
			Assert.AreEqual(Harmony.Core.FileIO.FileAccessResults.Success, fileIO.ReadRecord(shouldBeFirstOrder, 1))
			Assert.AreEqual(Harmony.Core.FileIO.FileAccessResults.Success, fileIO.FindFirstRecord())
			Assert.AreEqual(Harmony.Core.FileIO.FileAccessResults.Success, fileIO.ReadRecord(shouldBeFirstOrder2))
			Assert.AreEqual(Harmony.Core.FileIO.FileAccessResults.Success, fileIO.ReadNextRecord(nextOrder))
			Assert.AreEqual(Harmony.Core.FileIO.FileAccessResults.Success, fileIO.ReadLastRecord(lastOrder))


			Assert.AreEqual(firstOrder.Or_number, shouldBeFirstOrder.Or_number)
			Assert.AreEqual(firstOrder.Or_number, shouldBeFirstOrder2.Or_number)
			Assert.IsTrue(firstOrder.Or_number < nextOrder.Or_number)
			Assert.IsTrue(nextOrder.Or_number < lastOrder.Or_number)
		endmethod
	endclass
endnamespace
